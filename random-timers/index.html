<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gerador de Horários</title>
  </head>
  <body>
    <div>
      <p>
        Para se ter 10 horários por hora, basta multiplicar a quantidade pelo
        total de horas. Se o ínicio for 00:00, e o fim for 23:59, são 24 horas,
        então 24 x 10 = 240, "240" seria o que deve ser colocado no qtd de
        horarios.
      </p>
      <div>
        início: <br />
        <input id="start" type="text" placeholder="ex: 13:00" />
      </div>

      <div>
        fim: <br />
        <input id="end" type="text" placeholder="ex: 13:30" />
      </div>

      <div>
        qtd de horários: <br />
        <input id="count" type="number" placeholder="ex: 5" />
      </div>

      <div>
        <br />
        <button id="generator-btn">gerar</button>
      </div>

      <div id="results"></div>
    </div>

    <script>
      const startTime = document.getElementById("start");
      const endTime = document.getElementById("end");
      const count = document.getElementById("count");
      const generatorBtn = document.getElementById("generator-btn");
      const results = document.getElementById("results");

      generatorBtn.addEventListener("click", () =>
        generateRandomTimes(startTime.value, endTime.value, count.value)
      );

      function generateRandomTimes(startTime, endTime, count) {
        if (!startTime || !endTime || !count) return alert("Faltando dados");

        console.log(`start:${startTime}\nend:${endTime}\ncount:${count}\n`);

        results.innerHTML = "";

        startTime = startTime.trim();
        endTime = endTime.trim();
        count = parseInt(count, 10);

        const start = parseTime(startTime);
        const end = parseTime(endTime);

        if (!start || !end) return alert("Formato de hora inválido");

        const times = [];

        const timeDiff =
          (end.hour * 60 + end.minute - (start.hour * 60 + start.minute)) /
          count;

        for (let i = 0; i < count; i++) {
          const randomFactor = Math.random() * timeDiff;
          const minutes = Math.floor(
            start.hour * 60 + start.minute + i * timeDiff + randomFactor
          );
          const hours = Math.floor(minutes / 60) % 24;
          const minutesOfDay = minutes % 60;
          const formattedHours = String(hours).padStart(2, "0");
          const formattedMinutes = String(minutesOfDay).padStart(2, "0");
          times.push(`${formattedHours}:${formattedMinutes}`);
        }

        times.forEach((time) => {
          results.innerHTML += `<br>⏰ ${time}`;
        });

        return times;
      }

      function parseTime(time) {
        const pattern = /^(\d{1,2}):(\d{2})$/;
        const match = pattern.exec(time);
        if (match) {
          const hour = parseInt(match[1], 10);
          const minute = parseInt(match[2], 10);
          if (hour >= 0 && hour <= 23 && minute >= 0 && minute <= 59) {
            return { hour, minute };
          }
        }
        return null;
      }
    </script>
  </body>
</html>
